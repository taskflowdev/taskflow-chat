<div class="chat-conversation" *ngIf="conversation; else noConversationSelected">
  <!-- Conversation Header -->
  <div class="conversation-header">
    <div class="conversation-info">
      <h4 class="conversation-title">{{ conversation.groupName }}</h4>
      <p class="conversation-subtitle" *ngIf="conversation.memberCount">
        {{ conversation.memberCount }} member{{ conversation.memberCount !== 1 ? 's' : '' }}
      </p>
    </div>

    <div class="conversation-actions">
      <button class="btn action-btn" title="More options">
        <i class="bi bi-three-dots-vertical"></i>
      </button>
    </div>
  </div>

  <!-- Messages Container -->
  <div class="messages-container" #messagesContainer>
    <div class="messages-list">
      <app-chat-message *ngFor="let message of conversation.messages; trackBy: trackByMessageId" [message]="message">
      </app-chat-message>
    </div>
  </div>

  <!-- Message Input -->
  <div class="message-input-container">
    <div class="input-wrapper">
      <textarea 
        [(ngModel)]="newMessage" 
        (keydown)="onKeyDown($event)" 
        placeholder="Type a message..."
        class="message-input" 
        rows="1"
        [disabled]="isSending">
      </textarea>
      <button 
        class="btn send-btn" 
        (click)="onSendMessage()" 
        [disabled]="!newMessage.trim() || isSending" 
        title="Send message">
        <app-loading-spinner 
          *ngIf="isSending" 
          size="sm" 
          color="#ffffff" 
          [inline]="true">
        </app-loading-spinner>
        <i *ngIf="!isSending" class="bi bi-send-fill"></i>
      </button>
    </div>
  </div>
</div>

<ng-template #noConversationSelected>
  <div class="no-conversation">
    <div class="placeholder-content">
      <i class="bi bi-chat-quote placeholder-icon"></i>
      <h3 class="placeholder-title">No Chat Selected</h3>
      <p class="placeholder-subtitle">Pick a chat to continue</p>
      <p class="placeholder-footer">
        <i class="bi bi-lock"></i> Messages are end-to-end encrypted
      </p>
    </div>
  </div>
</ng-template>