<div class="profile-container" *ngIf="currentUser$ | async as user; else loading">
  <!-- Profile Title -->
  <div class="profile-title-header">
    <h1 class="page-title">{{ 'settings.profile.public-profile' | translate }}</h1>
  </div>

  <!-- Profile Form -->
  <form [formGroup]="profileForm" (ngSubmit)="onSubmit()" class="profile-form">
    <!-- Name Field -->
    <div class="form-field">
      <app-common-input
        [label]="'settings.profile.fields.name.label' | translate"
        formControlName="fullName"
        [placeholder]="'settings.profile.fields.name.placeholder' | translate"
        [isInvalid]="hasError('fullName')"
        [errorMessage]="getErrorMessage('fullName')"
        autocomplete="name"
      ></app-common-input>
      <p class="field-description">{{ 'settings.profile.fields.name.description' | translate }}</p>
    </div>

    <!-- Public Email Field -->
    <div class="form-field">
      <app-common-input
        [label]="'settings.profile.fields.public-email.label' | translate"
        formControlName="email"
        type="email"
        [placeholder]="'settings.profile.fields.public-email.placeholder' | translate"
        [isInvalid]="hasError('email')"
        [errorMessage]="getErrorMessage('email')"
        autocomplete="email"
      ></app-common-input>
      <p class="field-description">{{ 'settings.profile.fields.public-email.description' | translate }}</p>
    </div>

    <!-- Bio Field -->
    <div class="form-field">
      <label class="form-label">{{ 'settings.profile.fields.bio.label' | translate }}</label>
      <textarea
        formControlName="bio"
        [placeholder]="'settings.profile.fields.bio.placeholder' | translate"
        class="form-textarea"
        [class.is-invalid]="hasError('bio')"
        rows="4"
      ></textarea>
      <p class="field-description">{{ 'settings.profile.fields.bio.description' | translate }}</p>
      <div class="error-message" *ngIf="hasError('bio')">
        {{ getErrorMessage('bio') }}
      </div>
    </div>

    <!-- Username Display (Read-only) -->
    <div class="form-field">
      <label class="form-label">{{ 'settings.profile.fields.username.label' | translate }}</label>
      <div class="readonly-field">
        <span class="readonly-value">{{ user.userName }}</span>
      </div>
      <p class="field-description">{{ 'settings.profile.fields.username.description' | translate }}</p>
    </div>

    <!-- URL Field -->
    <div class="form-field">
      <app-common-input
        [label]="'settings.profile.fields.url.label' | translate"
        formControlName="url"
        type="url"
        [placeholder]="'settings.profile.fields.url.placeholder' | translate"
        [isInvalid]="hasError('url')"
        [errorMessage]="getErrorMessage('url')"
        autocomplete="url"
      ></app-common-input>
      <p class="field-description">{{ 'settings.profile.fields.url.description' | translate }}</p>
    </div>

    <!-- Save Button -->
    <div class="form-actions">
      <app-common-button
        type="submit"
        variant="success"
        [loading]="isSaving"
        [disabled]="profileForm.invalid || isSaving"
      >
        {{ 'settings.profile.actions.save' | translate }}
      </app-common-button>
    </div>
  </form>

  <!-- Profile Footer (Joined Date) -->
  <div class="profile-footer">
    <p class="joined-date">
      <i class="bi bi-calendar-check"></i>
      {{ 'settings.profile.joined-on' | translate }} {{ formatDate(user.createdAt) }}
    </p>
  </div>
</div>

<ng-template #loading>
  <div class="profile-container">
    <app-skeleton-loader type="profile-page"></app-skeleton-loader>
  </div>
</ng-template>
