<div class="dialog-overlay" (click)="onOverlayClick($event)">
  <div class="dialog-container">
    <!-- Header -->
    <div class="dialog-header">
      <div class="header-content">
        <i class="bi bi-search"></i>
        <h2 class="dialog-title">Search Settings</h2>
      </div>
      <button class="close-btn" (click)="onClose()" aria-label="Close dialog">
        <i class="bi bi-x-lg"></i>
      </button>
    </div>

    <!-- Search Input -->
    <div class="dialog-search">
      <div class="search-input-wrapper">
        <i class="bi bi-search search-icon"></i>
        <input
          #searchInput
          type="text"
          class="search-input"
          placeholder="Search for settings..."
          [(ngModel)]="searchQuery"
          (input)="onSearchInput($event)"
          aria-label="Search settings"
          aria-describedby="search-result-count"
        />
        <button
          *ngIf="searchQuery"
          class="clear-button"
          (click)="clearSearch()"
          aria-label="Clear search"
          type="button"
        >
          <i class="bi bi-x-lg"></i>
        </button>
      </div>
      <div
        id="search-result-count"
        class="search-result-count"
        aria-live="polite"
        aria-atomic="true"
        *ngIf="searchQuery"
      >
        {{ resultCount }} {{ resultCount === 1 ? 'result' : 'results' }}
      </div>
    </div>

    <!-- Content -->
    <div class="dialog-body">
      <div class="dialog-content">
        <!-- Search Results -->
        <div class="search-results-list" *ngIf="searchResults.length > 0; else noResults">
          <div
            *ngFor="let result of searchResults; let i = index; trackBy: trackByResultId"
            class="search-result-item"
            [class.selected]="isSelected(i)"
            [attr.data-result-index]="i"
            (click)="onResultClick(result)"
            role="button"
            tabindex="0"
            [attr.aria-label]="result.label + ' in ' + result.categoryLabel"
          >
            <div class="result-header">
              <div class="result-title">
                {{ result.label }}
              </div>
              <div class="result-badges">
                <span class="category-badge">
                  {{ result.categoryLabel }}
                </span>
                <span
                  *ngFor="let badge of getStatusBadges(result)"
                  class="status-badge"
                  [class.disabled]="badge === 'Disabled'"
                  [class.admin-only]="badge === 'Admin Only'"
                  [class.deprecated]="badge === 'Deprecated'"
                >
                  {{ badge }}
                </span>
              </div>
            </div>
            <div class="result-description" *ngIf="result.summary || result.description">
              {{ result.summary || result.description }}
            </div>
            <div class="result-meta" *ngIf="result.group">
              <span class="result-group">{{ result.group }}</span>
            </div>
          </div>
        </div>

        <ng-template #noResults>
          <div class="no-results" *ngIf="searchQuery">
            <i class="bi bi-search"></i>
            <p>No settings found</p>
            <span class="no-results-hint">Try different keywords</span>
          </div>
          <div class="empty-state" *ngIf="!searchQuery">
            <i class="bi bi-search"></i>
            <p>Start typing to search settings</p>
            <span class="empty-state-hint">Search across labels, descriptions, tags, and more</span>
          </div>
        </ng-template>
      </div>
    </div>

    <!-- Footer -->
    <div class="dialog-footer">
      <div class="footer-hints">
        <span class="hint"><kbd>↑</kbd><kbd>↓</kbd> Navigate</span>
        <span class="hint"><kbd>↵</kbd> Select</span>
        <span class="hint"><kbd>Esc</kbd> Close</span>
      </div>
    </div>
  </div>
</div>
