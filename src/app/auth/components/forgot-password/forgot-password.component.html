<div class="auth-container">
  <div class="auth-card">
    <!-- Success State -->
    <div *ngIf="isEmailSent; else resetForm" class="text-center">
      <div class="auth-header">
        <div class="mb-3">
          <i class="bi bi-envelope-check-fill" style="font-size: 4rem; color: var(--primary-green);"></i>
        </div>
        <h2>Check Your Email</h2>
        <p>We've sent password reset instructions to your email address.</p>
      </div>
      
      <div class="alert alert-success d-flex align-items-center mb-3" role="alert">
        <i class="bi bi-info-circle-fill me-2"></i>
        If you don't receive an email within a few minutes, please check your spam folder.
      </div>
      
      <div class="d-grid gap-2">
        <a routerLink="/auth/login" class="btn btn-primary">
          <i class="bi bi-arrow-left me-2"></i>
          Back to Login
        </a>
        <button type="button" class="btn btn-outline-secondary" (click)="isEmailSent = false">
          <i class="bi bi-arrow-clockwise me-2"></i>
          Try Again
        </button>
      </div>
    </div>

    <!-- Reset Form -->
    <ng-template #resetForm>
      <div class="auth-header">
        <div class="mb-3">
          <i class="bi bi-key-fill" style="font-size: 3rem; color: var(--primary-green);"></i>
        </div>
        <h2>Reset Password</h2>
        <p>Enter your email address and we'll send you instructions to reset your password.</p>
      </div>

      <!-- Error Alert -->
      <div *ngIf="errorMessage" class="alert alert-danger d-flex align-items-center mb-3" role="alert">
        <i class="bi bi-exclamation-triangle-fill me-2"></i>
        {{ errorMessage }}
      </div>

      <!-- Reset Form -->
      <form [formGroup]="forgotPasswordForm" (ngSubmit)="onSubmit()" novalidate>
        <!-- Email Field -->
        <div class="form-floating mb-4">
          <input 
            type="email" 
            class="form-control"
            [class.is-invalid]="getFieldError('email')"
            id="email"
            formControlName="email"
            placeholder="Email address"
            autocomplete="email">
          <label for="email">
            <i class="bi bi-envelope me-2"></i>Email Address
          </label>
          <div *ngIf="getFieldError('email')" class="invalid-feedback">
            {{ getFieldError('email') }}
          </div>
        </div>

        <!-- Reset Button -->
        <button 
          type="submit" 
          class="btn btn-primary w-100 mb-3"
          [disabled]="isLoading">
          <span *ngIf="isLoading" class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
          <i *ngIf="!isLoading" class="bi bi-envelope-arrow-up me-2"></i>
          {{ isLoading ? 'Sending...' : 'Send Reset Instructions' }}
        </button>

        <!-- Back to Login -->
        <div class="text-center">
          <a routerLink="/auth/login" class="auth-link">
            <i class="bi bi-arrow-left me-1"></i>
            Back to Login
          </a>
        </div>
      </form>
    </ng-template>
  </div>
</div>
